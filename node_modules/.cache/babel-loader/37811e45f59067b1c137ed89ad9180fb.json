{"remainingRequest":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/babel-loader/lib/index.js!/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/Planning.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/Planning.vue","mtime":1589404050020},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnRpZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnR5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvaG9tZS9zYW56aGFyL1B1YmxpYy9Qcm9qZWN0cy9WdWUgUHJvamVjdHMvc2hvcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUtY29yZWpzMy9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IGN1cnJlbmN5RmlsdGVyIGZyb20gJ0AvZmlsdGVycy9jdXJyZW5jeS5maWx0ZXInOwpleHBvcnQgZGVmYXVsdCB7CiAgbWV0YUluZm86IGZ1bmN0aW9uIG1ldGFJbmZvKCkgewogICAgcmV0dXJuIHsKICAgICAgdGl0bGU6IHRoaXMuJHRpdGxlKCdNZW51X1BsYW5uaW5nJykKICAgIH07CiAgfSwKICBuYW1lOiAncGxhbm5pbmcnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICBjYXRlZ29yaWVzOiBbXQogICAgfTsKICB9LAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKHt9LCBtYXBHZXR0ZXJzKFsnaW5mbyddKSksCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciByZWNvcmRzLCBjYXRlZ29yaWVzOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBtb3VudGVkJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAodGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2ZldGNoUmVjb3JkcycpKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlY29yZHMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZmV0Y2hDYXRlZ29yaWVzJykpOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgY2F0ZWdvcmllcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubWFwKGZ1bmN0aW9uIChjYXQpIHsKICAgICAgICAgICAgICB2YXIgc3BlbmQgPSByZWNvcmRzLmZpbHRlcihmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgcmV0dXJuIHIuY2F0ZWdvcnlJZCA9PT0gY2F0LmlkOwogICAgICAgICAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgcmV0dXJuIHIudHlwZSA9PT0gJ291dGNvbWUnOwogICAgICAgICAgICAgIH0pLnJlZHVjZShmdW5jdGlvbiAodG90YWwsIHJlY29yZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsICs9ICtyZWNvcmQuYW1vdW50OwogICAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgICAgIHZhciBwZXJjZW50ID0gMTAwICogc3BlbmQgLyBjYXQubGltaXQ7CiAgICAgICAgICAgICAgdmFyIHByb2dyZXNzUGVyY2VudCA9IHBlcmNlbnQgPiAxMDAgPyAxMDAgOiBwZXJjZW50OwogICAgICAgICAgICAgIHZhciBwcm9ncmVzc0NvbG9yID0gcGVyY2VudCA8IDYwID8gJ2dyZWVuJyA6IHBlcmNlbnQgPCAxMDAgPyAneWVsbG93JyA6ICdyZWQnOwogICAgICAgICAgICAgIHZhciB0b29sdGlwVmFsdWUgPSBjYXQubGltaXQgLSBzcGVuZDsKICAgICAgICAgICAgICB2YXIgdG9vbHRpcCA9ICIiLmNvbmNhdCh0b29sdGlwVmFsdWUgPCAwID8gJ9Cf0YDQtdCy0YvRiNC10L3QuNC1INC90LA6ICcgOiAn0J7RgdGC0LDQu9C+0YHRjDogJywgIiAiKS5jb25jYXQoY3VycmVuY3lGaWx0ZXIoTWF0aC5hYnModG9vbHRpcFZhbHVlKSkpOwogICAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBjYXQsIHsKICAgICAgICAgICAgICAgIHByb2dyZXNzUGVyY2VudDogcHJvZ3Jlc3NQZXJjZW50LAogICAgICAgICAgICAgICAgcHJvZ3Jlc3NDb2xvcjogcHJvZ3Jlc3NDb2xvciwKICAgICAgICAgICAgICAgIHNwZW5kOiBzcGVuZCwKICAgICAgICAgICAgICAgIHRvb2x0aXA6IHRvb2x0aXAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBudWxsLCB0aGlzKTsKICB9Cn07"},{"version":3,"sources":["Planning.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA,SAAA,UAAA,QAAA,MAAA;AACA,OAAA,cAAA,MAAA,2BAAA;AACA,eAAA;AACA,EAAA,QADA,sBACA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,KAAA,MAAA,CAAA,eAAA;AADA,KAAA;AAGA,GALA;AAMA,EAAA,IAAA,EAAA,UANA;AAOA,EAAA,IAAA,EAAA;AAAA,WAAA;AACA,MAAA,OAAA,EAAA,IADA;AAEA,MAAA,UAAA,EAAA;AAFA,KAAA;AAAA,GAPA;AAWA,EAAA,QAAA,oBACA,UAAA,CAAA,CAAA,MAAA,CAAA,CADA,CAXA;AAcA,EAAA,OAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAeA,KAAA,MAAA,CAAA,QAAA,CAAA,cAAA,CAfA;;AAAA;AAeA,YAAA,OAfA;AAAA;AAAA,4CAgBA,KAAA,MAAA,CAAA,QAAA,CAAA,iBAAA,CAhBA;;AAAA;AAgBA,YAAA,UAhBA;AAkBA,iBAAA,UAAA,GAAA,UAAA,CAAA,GAAA,CAAA,UAAA,GAAA,EAAA;AACA,kBAAA,KAAA,GAAA,OAAA,CACA,MADA,CACA,UAAA,CAAA;AAAA,uBAAA,CAAA,CAAA,UAAA,KAAA,GAAA,CAAA,EAAA;AAAA,eADA,EAEA,MAFA,CAEA,UAAA,CAAA;AAAA,uBAAA,CAAA,CAAA,IAAA,KAAA,SAAA;AAAA,eAFA,EAGA,MAHA,CAGA,UAAA,KAAA,EAAA,MAAA,EAAA;AACA,uBAAA,KAAA,IAAA,CAAA,MAAA,CAAA,MAAA;AACA,eALA,EAKA,CALA,CAAA;AAOA,kBAAA,OAAA,GAAA,MAAA,KAAA,GAAA,GAAA,CAAA,KAAA;AACA,kBAAA,eAAA,GAAA,OAAA,GAAA,GAAA,GAAA,GAAA,GAAA,OAAA;AACA,kBAAA,aAAA,GAAA,OAAA,GAAA,EAAA,GACA,OADA,GAEA,OAAA,GAAA,GAAA,GACA,QADA,GAEA,KAJA;AAMA,kBAAA,YAAA,GAAA,GAAA,CAAA,KAAA,GAAA,KAAA;AACA,kBAAA,OAAA,aAAA,YAAA,GAAA,CAAA,GAAA,iBAAA,GAAA,YAAA,cAAA,cAAA,CAAA,IAAA,CAAA,GAAA,CAAA,YAAA,CAAA,CAAA,CAAA;AAEA,uCACA,GADA;AAEA,gBAAA,eAAA,EAAA,eAFA;AAGA,gBAAA,aAAA,EAAA,aAHA;AAIA,gBAAA,KAAA,EAAA,KAJA;AAKA,gBAAA,OAAA,EAAA;AALA;AAOA,aA1BA,CAAA;AA4BA,iBAAA,OAAA,GAAA,KAAA;;AA9CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAA","sourcesContent":["<template>\n  <div>\n    <div class=\"page-title\">\n      <h3>{{'Menu_Planning' | localize}}</h3>\n      <h4>{{info.bill | currency('KZT')}}</h4>\n    </div>\n\n    <Loader v-if=\"loading\" />\n\n    <p class=\"center\" v-else-if=\"!categories.length\">Категорий пока нет. <router-link to=\"/categories\">Добавить новую категорию</router-link></p>\n\n    <section v-else>\n      <div v-for=\"cat in categories\" :key=\"cat.id\">\n        <p>\n          <strong>{{cat.title}}:</strong>\n          {{cat.spend | currency}} из {{cat.limit | currency}}\n        </p>\n        <div class=\"progress\" v-tooltip=\"cat.tooltip\">\n          <div \n            class=\"determinate\" \n            :class=\"[cat.progressColor]\" \n            :style=\"{width: cat.progressPercent + '%'}\"\n          ></div>\n        </div>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script>\nimport {mapGetters} from 'vuex'\nimport currencyFilter from '@/filters/currency.filter'\nexport default {\n  metaInfo() {\n      return {\n          title: this.$title('Menu_Planning')\n      }\n  },\n  name: 'planning',\n  data: () => ({\n    loading: true,\n    categories: []\n  }),\n  computed: {\n    ...mapGetters(['info'])\n  },\n  async mounted() {\n    const records = await this.$store.dispatch('fetchRecords')\n    const categories = await this.$store.dispatch('fetchCategories')\n\n    this.categories = categories.map(cat => {\n      const spend = records\n        .filter(r => r.categoryId === cat.id)\n        .filter(r => r.type === 'outcome')\n        .reduce((total, record) => {\n          return total += +record.amount\n        }, 0)\n\n      const percent = 100 * spend / cat.limit\n      const progressPercent = percent > 100 ? 100 : percent\n      const progressColor = percent < 60\n        ? 'green'\n        : percent < 100\n          ? 'yellow'\n          : 'red'\n\n      const tooltipValue = cat.limit - spend\n      const tooltip = `${tooltipValue < 0 ? 'Превышение на: ' : 'Осталось: '} ${currencyFilter(Math.abs(tooltipValue))}`\n\n      return {\n        ...cat,\n        progressPercent,\n        progressColor,\n        spend,\n        tooltip\n      }\n    })\n\n    this.loading = false\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@media (max-width: 400px) {\n  .page-title {\n    flex-direction: column;\n    align-items: flex-start;\n    h4 {\n      font-size: 1.4rem;\n      margin-top: 0.5rem;\n      font-weight: 700;\n    }\n  }\n}\n</style>"],"sourceRoot":"src/views"}]}