{"remainingRequest":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/Record.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/Record.vue","mtime":1590334179944},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAge3JlcXVpcmVkLCBtaW5WYWx1ZX0gZnJvbSAndnVlbGlkYXRlL2xpYi92YWxpZGF0b3JzJwppbXBvcnQge21hcEdldHRlcnN9IGZyb20gJ3Z1ZXgnCgpleHBvcnQgZGVmYXVsdCB7CiAgbWV0YUluZm8oKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgICB0aXRsZTogdGhpcy4kdGl0bGUoJ01lbnVfTmV3UmVjb3JkJykKICAgICAgfQogIH0sCiAgbmFtZTogJ3JlY29yZCcsCiAgZGF0YTogKCkgPT4gKHsKICAgIGxvYWRpbmc6IHRydWUsCiAgICBzZWxlY3Q6ICcnLAogICAgaW1nOiAnJywKICAgIHRpdGxlOiAnJywKICAgIGNhdGVnb3JpZXM6IFtdLAogICAgY2F0ZWdvcnk6IG51bGwsCiAgICBhbW91bnQ6IDEsCiAgICBkZXNjcmlwdGlvbjogJycKICB9KSwKICB2YWxpZGF0aW9uczogewogICAgICBhbW91bnQ6IHttaW5WYWx1ZTogbWluVmFsdWUoMSl9LAogICAgICBkZXNjcmlwdGlvbjoge3JlcXVpcmVkfQogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIHRoaXMuY2F0ZWdvcmllcyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdmZXRjaENhdGVnb3JpZXMnKQogICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKCiAgICBpZih0aGlzLmNhdGVnb3JpZXMubGVuZ3RoKSB7CiAgICAgIHRoaXMuY2F0ZWdvcnkgPSB0aGlzLmNhdGVnb3JpZXNbMF0uaWQKICAgIH0KCiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgdGhpcy5zZWxlY3QgPSBNLkZvcm1TZWxlY3QuaW5pdCh0aGlzLiRyZWZzLnNlbGVjdCkKICAgICAgTS51cGRhdGVUZXh0RmllbGRzKCkKICAgIH0sIDApCiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbJ2luZm8nXSksCiAgIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgaGFuZGxlU3VibWl0KCkgewogICAgICBpZiAodGhpcy4kdi4kaW52YWxpZCkgewogICAgICAgICAgdGhpcy4kdi4kdG91Y2goKQogICAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NyZWF0ZVJlY29yZCcsIHsKICAgICAgICAgIGltZzogdGhpcy5pbWcsCiAgICAgICAgICB0aXRsZTogdGhpcy50aXRsZSwKICAgICAgICAgIGNhdGVnb3J5SWQ6IHRoaXMuY2F0ZWdvcnksCiAgICAgICAgICBhbW91bnQ6IHRoaXMuYW1vdW50LAogICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuZGVzY3JpcHRpb24sCiAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSlNPTigpCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaChgdXBkYXRlSW5mb2ApCiAgICAgICAgdGhpcy4kbWVzc2FnZSgn0JfQsNC/0LjRgdGMINGD0YHQv9C10YjQvdC+INGB0L7Qt9C00LDQvdCwJykKICAgICAgICB0aGlzLiR2LiRyZXNldCgpCiAgICAgICAgdGhpcy5hbW91bnQgPSAxCiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9ICcnCiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBjb25zb2xlLmxvZyhlKQogICAgICB9CiAgICAKICAgIH0KICB9LAogIGRlc3Ryb3llZCgpIHsKICAgIGlmICh0aGlzLnNlbGVjdCAmJiB0aGlzLnNlbGVjdC5kZXN0cm95ZWQpIHsKICAgICAgICB0aGlzLnNlbGVjdC5kZXN0cm95ZWQoKQogICAgfQogIH0KfQo="},{"version":3,"sources":["Record.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Record.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <div class=\"page-title\">\n      <h3>Добавление продукта</h3>\n    </div>\n\n    <Loader v-if=\"loading\" />\n    \n    <form class=\"form\" v-else @submit.prevent=\"handleSubmit\">\n      <div class=\"input-field\">\n        <input id=\"img\" type=\"text\" v-model=\"img\" :class=\"{invalid: $v.description.$dirty && !$v.description.required}\" />\n        <label for=\"img\">URL картинки</label>\n        <span \n            v-if=\"$v.description.$dirty && !$v.description.required\"\n            class=\"helper-text invalid\"\n        >\n            {{'Enter_description' | localize}}\n        </span>\n      </div>\n\n      <div class=\"input-field\">\n        <input id=\"title\" type=\"text\" v-model=\"title\" :class=\"{invalid: $v.description.$dirty && !$v.description.required}\" />\n        <label for=\"title\">Название</label>\n        <span \n            v-if=\"$v.description.$dirty && !$v.description.required\"\n            class=\"helper-text invalid\"\n        >\n            {{'Enter_description' | localize}}\n        </span>\n      </div>\n\n      <div class=\"input-field\">\n        <select ref=\"select\" v-model=\"category\">\n          <option v-for=\"cat in categories\" :key=\"cat.id\" :value=\"cat.id\">{{cat.title}}</option>\n        </select>\n        <label>{{'Select_Category' | localize}}</label>\n      </div>\n\n      <div class=\"input-field\">\n        <input id=\"amount\" type=\"number\" v-model.number=\"amount\" :class=\"{invalid: $v.amount.$dirty && !$v.amount.minValue}\"/>\n        <label for=\"amount\">{{'Amount' | localize}}</label>\n        <span \n          class=\"helper-text invalid\"\n          v-if=\"$v.amount.$dirty && !$v.amount.minValue\"\n        >\n          {{'Minimum_value' | localize}} {{$v.amount.$params.minValue.min}}\n        </span>\n      </div>\n\n      <div class=\"input-field\">\n        <input id=\"description\" type=\"text\" v-model=\"description\" :class=\"{invalid: $v.description.$dirty && !$v.description.required}\" />\n        <label for=\"description\">{{'Description' | localize}}</label>\n        <span \n            v-if=\"$v.description.$dirty && !$v.description.required\"\n            class=\"helper-text invalid\"\n        >\n            {{'Enter_description' | localize}}\n        </span>\n      </div>\n\n      <button class=\"btn waves-effect waves-light\" style=\"background: #4fc3f7\" type=\"submit\">\n        {{'Create' | localize}}\n        <i class=\"material-icons right\">send</i>\n      </button>\n    </form>\n  </div>\n</template>\n\n<script>\nimport  {required, minValue} from 'vuelidate/lib/validators'\nimport {mapGetters} from 'vuex'\n\nexport default {\n  metaInfo() {\n      return {\n          title: this.$title('Menu_NewRecord')\n      }\n  },\n  name: 'record',\n  data: () => ({\n    loading: true,\n    select: '',\n    img: '',\n    title: '',\n    categories: [],\n    category: null,\n    amount: 1,\n    description: ''\n  }),\n  validations: {\n      amount: {minValue: minValue(1)},\n      description: {required}\n  },\n  async mounted() {\n    this.categories = await this.$store.dispatch('fetchCategories')\n    this.loading = false\n\n    if(this.categories.length) {\n      this.category = this.categories[0].id\n    }\n\n    setTimeout(() => {\n      this.select = M.FormSelect.init(this.$refs.select)\n      M.updateTextFields()\n    }, 0)\n  },\n  computed: {\n    ...mapGetters(['info']),\n   },\n  methods: {\n    async handleSubmit() {\n      if (this.$v.$invalid) {\n          this.$v.$touch()\n          return\n      }\n      \n      try {\n        await this.$store.dispatch('createRecord', {\n          img: this.img,\n          title: this.title,\n          categoryId: this.category,\n          amount: this.amount,\n          description: this.description,\n          date: new Date().toJSON()\n        })\n        \n        await this.$store.dispatch(`updateInfo`)\n        this.$message('Запись успешно создана')\n        this.$v.$reset()\n        this.amount = 1\n        this.description = ''\n      } catch (e) {\n        console.log(e)\n      }\n    \n    }\n  },\n  destroyed() {\n    if (this.select && this.select.destroyed) {\n        this.select.destroyed()\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n.form {\n  margin: 0 auto;\n}\n.page-title {\n  justify-content: center;\n}\n@media (max-width: 400px) {\n  .page-title {\n    margin-bottom: 2rem;\n  }\n  .input-field {\n    margin-top: 1.25rem;\n  }\n}\n</style>"]}]}