{"remainingRequest":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/Planning.vue?vue&type=style&index=0&id=83cbf9d2&lang=scss&scoped=true&","dependencies":[{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/Planning.vue","mtime":1589404050020},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQG1lZGlhIChtYXgtd2lkdGg6IDQwMHB4KSB7CiAgLnBhZ2UtdGl0bGUgewogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OwogICAgaDQgewogICAgICBmb250LXNpemU6IDEuNHJlbTsKICAgICAgbWFyZ2luLXRvcDogMC41cmVtOwogICAgICBmb250LXdlaWdodDogNzAwOwogICAgfQogIH0KfQo="},{"version":3,"sources":["Planning.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Planning.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <div class=\"page-title\">\n      <h3>{{'Menu_Planning' | localize}}</h3>\n      <h4>{{info.bill | currency('KZT')}}</h4>\n    </div>\n\n    <Loader v-if=\"loading\" />\n\n    <p class=\"center\" v-else-if=\"!categories.length\">Категорий пока нет. <router-link to=\"/categories\">Добавить новую категорию</router-link></p>\n\n    <section v-else>\n      <div v-for=\"cat in categories\" :key=\"cat.id\">\n        <p>\n          <strong>{{cat.title}}:</strong>\n          {{cat.spend | currency}} из {{cat.limit | currency}}\n        </p>\n        <div class=\"progress\" v-tooltip=\"cat.tooltip\">\n          <div \n            class=\"determinate\" \n            :class=\"[cat.progressColor]\" \n            :style=\"{width: cat.progressPercent + '%'}\"\n          ></div>\n        </div>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script>\nimport {mapGetters} from 'vuex'\nimport currencyFilter from '@/filters/currency.filter'\nexport default {\n  metaInfo() {\n      return {\n          title: this.$title('Menu_Planning')\n      }\n  },\n  name: 'planning',\n  data: () => ({\n    loading: true,\n    categories: []\n  }),\n  computed: {\n    ...mapGetters(['info'])\n  },\n  async mounted() {\n    const records = await this.$store.dispatch('fetchRecords')\n    const categories = await this.$store.dispatch('fetchCategories')\n\n    this.categories = categories.map(cat => {\n      const spend = records\n        .filter(r => r.categoryId === cat.id)\n        .filter(r => r.type === 'outcome')\n        .reduce((total, record) => {\n          return total += +record.amount\n        }, 0)\n\n      const percent = 100 * spend / cat.limit\n      const progressPercent = percent > 100 ? 100 : percent\n      const progressColor = percent < 60\n        ? 'green'\n        : percent < 100\n          ? 'yellow'\n          : 'red'\n\n      const tooltipValue = cat.limit - spend\n      const tooltip = `${tooltipValue < 0 ? 'Превышение на: ' : 'Осталось: '} ${currencyFilter(Math.abs(tooltipValue))}`\n\n      return {\n        ...cat,\n        progressPercent,\n        progressColor,\n        spend,\n        tooltip\n      }\n    })\n\n    this.loading = false\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@media (max-width: 400px) {\n  .page-title {\n    flex-direction: column;\n    align-items: flex-start;\n    h4 {\n      font-size: 1.4rem;\n      margin-top: 0.5rem;\n      font-weight: 700;\n    }\n  }\n}\n</style>"]}]}