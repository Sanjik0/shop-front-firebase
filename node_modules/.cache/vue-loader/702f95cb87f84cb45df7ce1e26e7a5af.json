{"remainingRequest":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/History.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/History.vue","mtime":1589404050016},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBwYWdpbmF0aW9uTWl4aW4gZnJvbSAnQC9taXhpbnMvcGFnaW5hdGlvbi5taXhpbicKaW1wb3J0IEhpc3RvcnlUYWJsZSBmcm9tICdAL2NvbXBvbmVudHMvSGlzdG9yeVRhYmxlJwppbXBvcnQge1BpZX0gZnJvbSAndnVlLWNoYXJ0anMnCmltcG9ydCBsb2NhbGl6ZUZpbHRlciBmcm9tICdAL2ZpbHRlcnMvbG9jYWxpemUuZmlsdGVyJwoKZXhwb3J0IGRlZmF1bHQgewogIG1ldGFJbmZvKCkgewogICAgICByZXR1cm4gewogICAgICAgICAgdGl0bGU6IHRoaXMuJHRpdGxlKCdNZW51X0hpc3RvcnknKQogICAgICB9CiAgfSwKICBuYW1lOiAnaGlzdG9yeScsCiAgZXh0ZW5kczogUGllLAogIGNvbXBvbmVudHM6IHsKICAgIEhpc3RvcnlUYWJsZQogIH0sCiAgbWl4aW5zOiBbcGFnaW5hdGlvbk1peGluXSwKICBkYXRhOiAoKSA9PiAoewogICAgbG9hZGluZzogdHJ1ZSwKICAgIHJlY29yZHM6IFtdLAogICAgcHJldjogbG9jYWxpemVGaWx0ZXIoJ1ByZXYnKSwKICAgIG5leHQ6IGxvY2FsaXplRmlsdGVyKCdOZXh0JykKICB9KSwKICBhc3luYyBtb3VudGVkKCkgewogICAgdGhpcy5yZWNvcmRzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2ZldGNoUmVjb3JkcycpCiAgICBjb25zdCBjYXRlZ29yaWVzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2ZldGNoQ2F0ZWdvcmllcycpCgogICAgdGhpcy5zZXR1cChjYXRlZ29yaWVzKQoKICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgfSwKICBtZXRob2RzOiB7CiAgICBzZXR1cChjYXRlZ29yaWVzKSB7CiAgICAgIHRoaXMuc2V0dXBQYWdpbmF0aW9uKHRoaXMucmVjb3Jkcy5tYXAocmVjb3JkID0+IHsKICAgICAgICByZXR1cm4geyAgCiAgICAgICAgICAuLi5yZWNvcmQsCiAgICAgICAgICBjYXRlZ29yeU5hbWU6IGNhdGVnb3JpZXMuZmluZChjID0+IGMuaWQgPT09IHJlY29yZC5jYXRlZ29yeUlkKS50aXRsZSwKICAgICAgICAgIHR5cGVDbGFzczogcmVjb3JkLnR5cGUgPT09ICdpbmNvbWUnID8gJ2dyZWVuJyA6ICdyZWQnLAogICAgICAgICAgdHlwZVRleHQ6IHJlY29yZC50eXBlID09PSAnaW5jb21lJyA/IGxvY2FsaXplRmlsdGVyKCdJbmNvbWUnKSA6IGxvY2FsaXplRmlsdGVyKCdPdXRjb21lJykKICAgICAgICB9CiAgICAgIH0pKQoKICAgICAgdGhpcy5yZW5kZXJDaGFydCh7CiAgICAgICAgbGFiZWxzOiBjYXRlZ29yaWVzLm1hcChjID0+IGMudGl0bGUpLAogICAgICAgIGRhdGFzZXRzOiBbewogICAgICAgICAgICBsYWJlbDogbG9jYWxpemVGaWx0ZXIoJ0Nvc3RzX2J5X9GBYXRlZ29yeScpLAogICAgICAgICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcChjID0+IHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNvcmRzLnJlZHVjZSgodG90YWwsIHIpID0+IHsKICAgICAgICAgICAgICAgIGlmIChyLmNhdGVnb3J5SWQgPT09IGMuaWQgJiYgci50eXBlID09PSAnb3V0Y29tZScpIHsKICAgICAgICAgICAgICAgICAgdG90YWwgKz0gK3IuYW1vdW50CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdG90YWwKICAgICAgICAgICAgICB9LCAwKQogICAgICAgICAgICB9KSwKICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBbCiAgICAgICAgICAgICAgICAncmdiYSgyNTUsIDk5LCAxMzIsIDAuMiknLAogICAgICAgICAgICAgICAgJ3JnYmEoNTQsIDE2MiwgMjM1LCAwLjIpJywKICAgICAgICAgICAgICAgICdyZ2JhKDI1NSwgMjA2LCA4NiwgMC4yKScsCiAgICAgICAgICAgICAgICAncmdiYSg3NSwgMTkyLCAxOTIsIDAuMiknLAogICAgICAgICAgICAgICAgJ3JnYmEoMTUzLCAxMDIsIDI1NSwgMC4yKScsCiAgICAgICAgICAgICAgICAncmdiYSgyNTUsIDE1OSwgNjQsIDAuMiknCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIGJvcmRlckNvbG9yOiBbCiAgICAgICAgICAgICAgICAncmdiYSgyNTUsIDk5LCAxMzIsIDEpJywKICAgICAgICAgICAgICAgICdyZ2JhKDU0LCAxNjIsIDIzNSwgMSknLAogICAgICAgICAgICAgICAgJ3JnYmEoMjU1LCAyMDYsIDg2LCAxKScsCiAgICAgICAgICAgICAgICAncmdiYSg3NSwgMTkyLCAxOTIsIDEpJywKICAgICAgICAgICAgICAgICdyZ2JhKDE1MywgMTAyLCAyNTUsIDEpJywKICAgICAgICAgICAgICAgICdyZ2JhKDI1NSwgMTU5LCA2NCwgMSknCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIGJvcmRlcldpZHRoOiAyCiAgICAgICAgfV0KICAgICAgfSkKICAgIH0KICB9Cn0gCg=="},{"version":3,"sources":["History.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"History.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <div class=\"page-title\">\n      <h3>{{'Menu_History' | localize}}</h3>\n    </div>\n\n    <div class=\"history-chart\">\n      <canvas ref=\"canvas\"></canvas>\n    </div>\n\n    <Loader v-if=\"loading\" />\n\n    <p class=\"center\" v-else-if=\"!records.length\">{{'No_posts_yet' | localize}} <router-link to=\"/record\">{{'Add_New_Entry' | localize}}</router-link></p>\n\n    <section class=\"table-wrapper\" v-else>\n      <HistoryTable :records=\"items\" />\n\n      <Paginate\n        v-model=\"page\"\n        :page-count=\"pageCount\"\n        :click-handler=\"pageChangeHandler\"\n        :prev-text=\"prev\"\n        :next-text=\"next\"\n        :container-class=\"'pagination'\"\n        :page-class=\"'waves-effect'\"\n      />\n    </section>\n  </div>\n</template>\n\n<script>\nimport paginationMixin from '@/mixins/pagination.mixin'\nimport HistoryTable from '@/components/HistoryTable'\nimport {Pie} from 'vue-chartjs'\nimport localizeFilter from '@/filters/localize.filter'\n\nexport default {\n  metaInfo() {\n      return {\n          title: this.$title('Menu_History')\n      }\n  },\n  name: 'history',\n  extends: Pie,\n  components: {\n    HistoryTable\n  },\n  mixins: [paginationMixin],\n  data: () => ({\n    loading: true,\n    records: [],\n    prev: localizeFilter('Prev'),\n    next: localizeFilter('Next')\n  }),\n  async mounted() {\n    this.records = await this.$store.dispatch('fetchRecords')\n    const categories = await this.$store.dispatch('fetchCategories')\n\n    this.setup(categories)\n\n    this.loading = false\n  },\n  methods: {\n    setup(categories) {\n      this.setupPagination(this.records.map(record => {\n        return {  \n          ...record,\n          categoryName: categories.find(c => c.id === record.categoryId).title,\n          typeClass: record.type === 'income' ? 'green' : 'red',\n          typeText: record.type === 'income' ? localizeFilter('Income') : localizeFilter('Outcome')\n        }\n      }))\n\n      this.renderChart({\n        labels: categories.map(c => c.title),\n        datasets: [{\n            label: localizeFilter('Costs_by_сategory'),\n            data: categories.map(c => {\n              return this.records.reduce((total, r) => {\n                if (r.categoryId === c.id && r.type === 'outcome') {\n                  total += +r.amount\n                }\n                return total\n              }, 0)\n            }),\n            backgroundColor: [\n                'rgba(255, 99, 132, 0.2)',\n                'rgba(54, 162, 235, 0.2)',\n                'rgba(255, 206, 86, 0.2)',\n                'rgba(75, 192, 192, 0.2)',\n                'rgba(153, 102, 255, 0.2)',\n                'rgba(255, 159, 64, 0.2)'\n            ],\n            borderColor: [\n                'rgba(255, 99, 132, 1)',\n                'rgba(54, 162, 235, 1)',\n                'rgba(255, 206, 86, 1)',\n                'rgba(75, 192, 192, 1)',\n                'rgba(153, 102, 255, 1)',\n                'rgba(255, 159, 64, 1)'\n            ],\n            borderWidth: 2\n        }]\n      })\n    }\n  }\n} \n</script>\n\n<style lang=\"scss\">\n.pagination li.active {\n  background: #26a69a;\n}\n.table-wrapper {\n  overflow-y: auto;\n}\n</style>"]}]}