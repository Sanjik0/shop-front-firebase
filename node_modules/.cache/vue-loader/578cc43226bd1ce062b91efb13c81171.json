{"remainingRequest":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/Planning.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/src/views/Planning.vue","mtime":1589404050020},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sanzhar/Public/Projects/Vue Projects/shop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwR2V0dGVyc30gZnJvbSAndnVleCcKaW1wb3J0IGN1cnJlbmN5RmlsdGVyIGZyb20gJ0AvZmlsdGVycy9jdXJyZW5jeS5maWx0ZXInCmV4cG9ydCBkZWZhdWx0IHsKICBtZXRhSW5mbygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICAgIHRpdGxlOiB0aGlzLiR0aXRsZSgnTWVudV9QbGFubmluZycpCiAgICAgIH0KICB9LAogIG5hbWU6ICdwbGFubmluZycsCiAgZGF0YTogKCkgPT4gKHsKICAgIGxvYWRpbmc6IHRydWUsCiAgICBjYXRlZ29yaWVzOiBbXQogIH0pLAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsnaW5mbyddKQogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIGNvbnN0IHJlY29yZHMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZmV0Y2hSZWNvcmRzJykKICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZmV0Y2hDYXRlZ29yaWVzJykKCiAgICB0aGlzLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzLm1hcChjYXQgPT4gewogICAgICBjb25zdCBzcGVuZCA9IHJlY29yZHMKICAgICAgICAuZmlsdGVyKHIgPT4gci5jYXRlZ29yeUlkID09PSBjYXQuaWQpCiAgICAgICAgLmZpbHRlcihyID0+IHIudHlwZSA9PT0gJ291dGNvbWUnKQogICAgICAgIC5yZWR1Y2UoKHRvdGFsLCByZWNvcmQpID0+IHsKICAgICAgICAgIHJldHVybiB0b3RhbCArPSArcmVjb3JkLmFtb3VudAogICAgICAgIH0sIDApCgogICAgICBjb25zdCBwZXJjZW50ID0gMTAwICogc3BlbmQgLyBjYXQubGltaXQKICAgICAgY29uc3QgcHJvZ3Jlc3NQZXJjZW50ID0gcGVyY2VudCA+IDEwMCA/IDEwMCA6IHBlcmNlbnQKICAgICAgY29uc3QgcHJvZ3Jlc3NDb2xvciA9IHBlcmNlbnQgPCA2MAogICAgICAgID8gJ2dyZWVuJwogICAgICAgIDogcGVyY2VudCA8IDEwMAogICAgICAgICAgPyAneWVsbG93JwogICAgICAgICAgOiAncmVkJwoKICAgICAgY29uc3QgdG9vbHRpcFZhbHVlID0gY2F0LmxpbWl0IC0gc3BlbmQKICAgICAgY29uc3QgdG9vbHRpcCA9IGAke3Rvb2x0aXBWYWx1ZSA8IDAgPyAn0J/RgNC10LLRi9GI0LXQvdC40LUg0L3QsDogJyA6ICfQntGB0YLQsNC70L7RgdGMOiAnfSAke2N1cnJlbmN5RmlsdGVyKE1hdGguYWJzKHRvb2x0aXBWYWx1ZSkpfWAKCiAgICAgIHJldHVybiB7CiAgICAgICAgLi4uY2F0LAogICAgICAgIHByb2dyZXNzUGVyY2VudCwKICAgICAgICBwcm9ncmVzc0NvbG9yLAogICAgICAgIHNwZW5kLAogICAgICAgIHRvb2x0aXAKICAgICAgfQogICAgfSkKCiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogIH0KfQo="},{"version":3,"sources":["Planning.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Planning.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <div class=\"page-title\">\n      <h3>{{'Menu_Planning' | localize}}</h3>\n      <h4>{{info.bill | currency('KZT')}}</h4>\n    </div>\n\n    <Loader v-if=\"loading\" />\n\n    <p class=\"center\" v-else-if=\"!categories.length\">Категорий пока нет. <router-link to=\"/categories\">Добавить новую категорию</router-link></p>\n\n    <section v-else>\n      <div v-for=\"cat in categories\" :key=\"cat.id\">\n        <p>\n          <strong>{{cat.title}}:</strong>\n          {{cat.spend | currency}} из {{cat.limit | currency}}\n        </p>\n        <div class=\"progress\" v-tooltip=\"cat.tooltip\">\n          <div \n            class=\"determinate\" \n            :class=\"[cat.progressColor]\" \n            :style=\"{width: cat.progressPercent + '%'}\"\n          ></div>\n        </div>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script>\nimport {mapGetters} from 'vuex'\nimport currencyFilter from '@/filters/currency.filter'\nexport default {\n  metaInfo() {\n      return {\n          title: this.$title('Menu_Planning')\n      }\n  },\n  name: 'planning',\n  data: () => ({\n    loading: true,\n    categories: []\n  }),\n  computed: {\n    ...mapGetters(['info'])\n  },\n  async mounted() {\n    const records = await this.$store.dispatch('fetchRecords')\n    const categories = await this.$store.dispatch('fetchCategories')\n\n    this.categories = categories.map(cat => {\n      const spend = records\n        .filter(r => r.categoryId === cat.id)\n        .filter(r => r.type === 'outcome')\n        .reduce((total, record) => {\n          return total += +record.amount\n        }, 0)\n\n      const percent = 100 * spend / cat.limit\n      const progressPercent = percent > 100 ? 100 : percent\n      const progressColor = percent < 60\n        ? 'green'\n        : percent < 100\n          ? 'yellow'\n          : 'red'\n\n      const tooltipValue = cat.limit - spend\n      const tooltip = `${tooltipValue < 0 ? 'Превышение на: ' : 'Осталось: '} ${currencyFilter(Math.abs(tooltipValue))}`\n\n      return {\n        ...cat,\n        progressPercent,\n        progressColor,\n        spend,\n        tooltip\n      }\n    })\n\n    this.loading = false\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@media (max-width: 400px) {\n  .page-title {\n    flex-direction: column;\n    align-items: flex-start;\n    h4 {\n      font-size: 1.4rem;\n      margin-top: 0.5rem;\n      font-weight: 700;\n    }\n  }\n}\n</style>"]}]}